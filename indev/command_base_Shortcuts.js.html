<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <title>command/base/Shortcuts.js - Documentation</title>

    <script src="scripts/prettify/prettify.js"></script>
    <script src="scripts/prettify/lang-css.js"></script>
    <!--[if lt IE 9]>
      <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->
    <link type="text/css" rel="stylesheet" href="https://code.ionicframework.com/ionicons/2.0.1/css/ionicons.min.css">
    <link type="text/css" rel="stylesheet" href="styles/prettify-tomorrow.css">
    <link type="text/css" rel="stylesheet" href="styles/jsdoc-default.css">
</head>
<body>

<input type="checkbox" id="nav-trigger" class="nav-trigger" />
<label for="nav-trigger" class="navicon-button x">
  <div class="navicon"></div>
</label>

<label for="nav-trigger" class="overlay"></label>

<nav>
    <h2><a href="/index.html">Stable</a><a href="/indev/index.html">Indev</a></h2><h3>Pages</h3><ul><li><a href="tutorial-LocalizationGuide.html">Localization Guide</a></li><li><a href="tutorial-LocalizationHelptext.html">Localizing Command helptext</a></li><li><a href="tutorial-LocalizationStrings.html">Localization string list</a></li><li><a href="tutorial-PluginAuthoring.html">Plugin Authoring Guide</a></li><li><a href="tutorial-PluginList.html">Plugin list</a></li><li><a href="tutorial-StartingInV3.html">Starting a bot in 3.0.0</a></li></ul><h3>Classes</h3><ul><li><a href="Client.html">Client</a></li><li><a href="ClientStorage.html">ClientStorage</a></li><li><a href="Command.html">Command</a></li><li><a href="CommandLock.html">CommandLock</a></li><li><a href="CommandRegistry.html">CommandRegistry</a></li><li><a href="CompactModeHelper.html">CompactModeHelper</a></li><li><a href="Database.html">Database</a></li><li><a href="Event.html">Event</a></li><li><a href="EventLoader.html">EventLoader</a></li><li><a href="GuildSettings.html">GuildSettings</a></li><li><a href="GuildStorage.html">GuildStorage</a></li><li><a href="KeyedStorage.html">KeyedStorage</a></li><li><a href="Logger.html">Logger</a></li><li><a href="Plugin.html">Plugin</a></li><li><a href="PluginLoader.html">PluginLoader</a></li><li><a href="RateLimit.html">RateLimit</a></li><li><a href="RateLimiter.html">RateLimiter</a></li><li><a href="RateLimitManager.html">RateLimitManager</a></li><li><a href="Resolver.html">Resolver</a></li><li><a href="ResolverLoader.html">ResolverLoader</a></li><li><a href="SharedProviderStorage.html">SharedProviderStorage</a></li><li><a href="SingleProviderStorage.html">SingleProviderStorage</a></li><li><a href="StorageProvider.html">StorageProvider</a></li></ul><h3>Interfaces</h3><ul><li><a href="IPlugin.html">IPlugin</a></li><li><a href="IStorageProvider.html">IStorageProvider</a></li></ul><h3>Mixins</h3><ul><li><a href="Guild.html">Guild</a></li><li><a href="Loggable.html">Loggable</a></li><li><a href="Message.html">Message</a></li></ul><h3>Modules</h3><ul><li><a href="module-CommandDecorators.html">CommandDecorators</a></li><li><a href="module-Lang.html">Lang</a></li><li><a href="module-ListenerUtil.html">ListenerUtil</a></li><li><a href="module-Middleware.html">Middleware</a></li><li><a href="module-Providers.html">Providers</a></li><li><a href="module-Time.html">Time</a></li><li><a href="module-Util.html">Util</a></li></ul><h3>Decorators</h3><ul><li><a href="global.html#deprecatedClass">deprecatedClass</a></li><li><a href="global.html#deprecatedMethod">deprecatedMethod</a></li><li><a href="global.html#logger">logger</a></li></ul><h3>TypeDefs</h3><ul><li><a href="global.html#ArgOpts">ArgOpts</a></li><li><a href="global.html#BaseResolverType">BaseResolverType</a></li><li><a href="global.html#BaseStrings">BaseStrings</a></li><li><a href="global.html#CommandInfo">CommandInfo</a></li><li><a href="global.html#DefaultGuildSettings">DefaultGuildSettings</a></li><li><a href="global.html#Difference">Difference</a></li><li><a href="global.html#LocalizedCommandInfo">LocalizedCommandInfo</a></li><li><a href="global.html#LogData">LogData</a></li><li><a href="global.html#LogLevel">LogLevel</a></li><li><a href="global.html#MiddlewareFunction">MiddlewareFunction</a></li><li><a href="global.html#PluginConstructor">PluginConstructor</a></li><li><a href="global.html#ResolverConstructor">ResolverConstructor</a></li><li><a href="global.html#ResourceLoader">ResourceLoader</a></li><li><a href="global.html#ResourceProxy">ResourceProxy</a></li><li><a href="global.html#RespondOptions">RespondOptions</a></li><li><a href="global.html#StorageProviderConstructor">StorageProviderConstructor</a></li><li><a href="global.html#TemplateData">TemplateData</a></li><li><a href="global.html#Transport">Transport</a></li><li><a href="global.html#TransportFunction">TransportFunction</a></li><li><a href="global.html#Tuple">Tuple</a></li><li><a href="global.html#YAMDBFOptions">YAMDBFOptions</a></li></ul><h3>Externals</h3><ul><li><a href="external-Client.html">Client</a></li><li><a href="external-ClientOptions.html">ClientOptions</a></li><li><a href="external-Collection.html">Collection</a></li><li><a href="external-Guild.html">Guild</a></li><li><a href="external-Message.html">Message</a></li><li><a href="external-MessageOptions.html">MessageOptions</a></li><li><a href="external-PermissionResolvable.html">PermissionResolvable</a></li><li><a href="external-Role.html">Role</a></li><li><a href="external-User.html">User</a></li></ul>
</nav>

<div id="main">
    

    



    
    <section>
        <article>
            <pre class="prettyprint source linenums"><code>import { Message } from '../../types/Message';
import { Command } from '../Command';
import { using } from '../CommandDecorators';
import { Middleware } from '../middleware/Middleware';
import { Util } from 'discord.js';
import { ResourceProxy } from '../../types/ResourceProxy';
const { resolve, expect, localize } = Middleware;

export default class extends Command
{
	public constructor()
	{
		super({
			name: 'shortcuts',
			desc: 'Configure or list command shortcuts',
			usage: `&lt;prefix>shortcuts ['get'|'set'|'remove'] [name] [...content]`,
			info: `Shortcuts allow creating and calling preconfigured command+argument sets, or simple aliases

Example:
	&lt;prefix>shortcuts set h help

Which would set the shortcut "h" to call the command "help"


Shortcuts also allow substitution tokens for argument interpolation.

Example:
	&lt;prefix>shortcuts set add eval %s + %s

Which would set the shortcut "add", to add two numbers --
"&lt;prefix>add 2 3", which becomes "&lt;prefix>eval 2 + 3"

Of course the eval command is owner-only, but this should give you an idea of how shortcuts work`,
			callerPermissions: ['ADMINISTRATOR']
		});
	}

	@using(resolve(`action: ['get', 'set', 'remove'], name: String, ...content: String`))
	@using(function(this: Command, message, args: string[])
	{
		if (args[0])
		{
			if (args[0] === 'set')
				return expect(`action: ['get', 'set', 'remove'], name: String, ...content: String`)
					.call(this, message, args);

			else
				return expect(`action: ['get', 'set', 'remove'], name: String`)
					.call(this, message, args);
		}
		else return [message, args];
	})
	@using(localize)
	public async action(message: Message, [res, action, name, content]: [ResourceProxy, string, string, string]): Promise&lt;any>
	{
		if (!action) return this.listShortcuts(message, res);
		else if (action === 'set') return this.setShortcut(message, res, name, content);
		else if (action === 'get') return this.getShortcut(message, res, name);
		else if (action === 'remove') return this.removeShortcut(message, res, name);
	}

	/**
	 * List command shortcuts
	 */
	private async listShortcuts(message: Message, res: ResourceProxy): Promise&lt;void>
	{
		const shortcuts: { [name: string]: string } = await message.guild.storage!.settings.get('shortcuts') ?? {};
		const names: string[] = Object.keys(shortcuts);

		let output: string;

		if (names.length === 0) output = res.CMD_SHORTCUTS_ERR_NO_SHORTCUTS();
		else output = res.CMD_SHORTCUTS_LIST({ names: names.join(', ') });

		this.respond(message, output);
	}

	/**
	 * Set command shortcut content
	 */
	private async setShortcut(message: Message, res: ResourceProxy, name: string, content: string): Promise&lt;any>
	{
		const shortcuts: { [name: string]: string } = await message.guild.storage!.settings.get('shortcuts') ?? {};
		if (Object.keys(shortcuts).length >= 50)
			return this.respond(message, res.CMD_SHORTCUTS_ERR_MAX_SHORTCUTS());

		if (content.length > 500)
			return this.respond(message, res.CMD_SHORTCUTS_ERR_SET_LENGTH());

		await message.guild.storage!.settings.set(`shortcuts.${name}`, content);

		content = Util.escapeMarkdown(content, { codeBlock: true, codeBlockContent: true });
		return this.respond(message, res.CMD_SHORTCUTS_SET_SUCCESS({ name, content }));
	}

	/**
	 * Get command shortcut content
	 */
	private async getShortcut(message: Message, res: ResourceProxy, name: string): Promise&lt;any>
	{
		const shortcuts: { [name: string]: string } = await message.guild.storage!.settings.get('shortcuts') ?? {};
		if (!shortcuts[name])
			return this.respond(message, res.CMD_SHORTCUTS_ERR_MISSING({ name }));

		const content: string = Util.escapeMarkdown(shortcuts[name], { codeBlock: true, codeBlockContent: true });
		return this.respond(message, res.CMD_SHORTCUTS_GET_CONTENT({ name, content }));
	}

	/**
	 * Remove a command shortcut
	 */
	private async removeShortcut(message: Message, res: ResourceProxy, name: string): Promise&lt;any>
	{
		const shortcuts: { [name: string]: string } = await message.guild.storage!.settings.get('shortcuts') ?? {};
		if (!shortcuts[name])
			return this.respond(message, res.CMD_SHORTCUTS_ERR_MISSING({ name }));

		await message.guild.storage!.settings.remove(`shortcuts.${name}`);
		return this.respond(message, res.CMD_SHORTCUTS_REMOVE_SUCCESS({ name }));
	}
}
</code></pre>
        </article>
    </section>





</div>

<br class="clear">

<footer>
	<div align="right">
    	<a href="https://github.com/jsdoc3/jsdoc">JSDoc3.5.0-dev</a> | Minami
	</div>
</footer>

<script>prettyPrint();</script>
<script src="scripts/linenumber.js"></script>
</body>
</html>
