{"version":3,"sources":["command/base/Eval.ts"],"names":[],"mappings":";;;;;;;;AAEA,wCAAqC;AACrC,4DAA6C;AAC7C,yDAAsD;AAEtD,0CAAuC;AACvC,+BAA+B;AAE/B,oDAAoD;AACpD,MAAM,OAAO,GAAG,OAAO,CAAC,YAAY,CAAC,CAAC;AACtC,oDAAoD;AACpD,MAAM,MAAM,GAAG,OAAO,CAAC,aAAa,CAAC,CAAC;AAEtC,eAAqB,SAAQ,iBAAO;IAEnC;QAEC,KAAK,CAAC;YACL,IAAI,EAAE,MAAM;YACZ,IAAI,EAAE,mCAAmC;YACzC,KAAK,EAAE,wBAAwB;YAC/B,SAAS,EAAE,IAAI;SACf,CAAC,CAAC;IACJ,CAAC;IAGM,KAAK,CAAC,MAAM,CAAC,OAAgB,EAAE,CAAC,GAAG,CAAkB;QAE3D,oDAAoD;QACpD,MAAM,MAAM,GAAW,IAAI,CAAC,MAAM,CAAC;QACnC,MAAM,CAAC,EAAC,AAAC,EAAE,MAAM,EAAE,IAAI,CAAC,GAAG,MAAM,WAAI,CAAC,gBAAgB,CAAC,OAAO,CAAC,CAAC;QAChE,MAAM,IAAI,GAAW,IAAI,MAAM,CAAC,IAAI,WAAI,CAAC,MAAM,CAAC,MAAM,CAAC,KAAK,IAAI,EAAE,CAAC,CAAC;QACpE,MAAM,IAAI,GAAW,OAAO,CAAC,OAAO,CAAC,OAAO,CAAC,IAAI,EAAE,EAAE,CAAC,CAAC,IAAI,EAAE,CAAC;QAE9D,IAAI,CAAC,IAAI;YAAE,OAAO,IAAI,CAAC,OAAO,CAAC,OAAO,EAAE,GAAG,CAAC,mBAAmB,EAAE,CAAC,CAAC;QAEnE,IAAI,MAAwB,CAAC;QAC7B,IAAI,KAAc,CAAC;QAEnB,IAAI;YAAE,MAAM,GAAG,MAAM,IAAI,CAAC,IAAI,CAAC,CAAC;SAAE;QAClC,OAAO,GAAG,EAAE;YAAE,KAAK,GAAG,GAAG,CAAC;SAAE;QAE5B,IAAI,KAAK;YAAE,OAAO,IAAI,CAAC,OAAO,CAAC,OAAO,EAAE,GAAG,CAAC,cAAc,CAAC,EAAE,IAAI,EAAE,KAAK,EAAE,IAAI,CAAC,MAAM,CAAC,KAAK,CAAC,EAAE,CAAC,CAAC,CAAC;QACjG,IAAI,OAAO,MAAM,KAAK,QAAQ;YAAE,MAAM,GAAG,cAAO,CAAC,MAAM,EAAE,EAAE,KAAK,EAAE,CAAC,EAAE,CAAC,CAAC;QAEvE,OAAO,IAAI,CAAC,OAAO,CAAC,OAAO,EAAE,GAAG,CAAC,eAAe,CAAC,EAAE,IAAI,EAAE,MAAM,EAAE,IAAI,CAAC,MAAM,CAAC,MAAM,CAAC,EAAE,CAAC,CAAC,CAAC;IAC1F,CAAC;IAEO,MAAM,CAAC,IAAY;QAE1B,OAAO,OAAO,IAAI,KAAK,QAAQ,CAAC,CAAC,CAAC,IAAI;aACpC,OAAO,CAAC,IAAI,EAAE,KAAK,MAAM,CAAC,YAAY,CAAC,IAAI,CAAC,EAAE,CAAC;aAC/C,OAAO,CAAC,IAAI,EAAE,IAAI,MAAM,CAAC,YAAY,CAAC,IAAI,CAAC,EAAE,CAAC;aAC9C,OAAO,CAAC,sCAAsC,EAAE,YAAY,CAAC;aAC7D,OAAO,CAAC,iBAAiB,EAAE,qBAAqB,CAAC;YAClD,CAAC,CAAC,IAAI,CAAC;IACT,CAAC;CACD;AA/BA;IADC,yBAAK,CAAC,uBAAU,CAAC,QAAQ,CAAC;uCAqB1B;AAjCF,4BA4CC","file":"Eval.js","sourcesContent":["import { Client } from '../../client/Client';\nimport { Message } from '../../types/Message';\nimport { Command } from '../Command';\nimport { using } from '../CommandDecorators';\nimport { Middleware } from '../middleware/Middleware';\nimport { ResourceProxy } from '../../types/ResourceProxy';\nimport { Util } from '../../util/Util';\nimport { inspect } from 'util';\n\n// @ts-ignore - Exposed for eval command invocations\nconst Discord = require('discord.js');\n// @ts-ignore - Exposed for eval command invocations\nconst Yamdbf = require('../../index');\n\nexport default class extends Command\n{\n\tpublic constructor()\n\t{\n\t\tsuper({\n\t\t\tname: 'eval',\n\t\t\tdesc: 'Evaluate provided Javascript code',\n\t\t\tusage: '<prefix>eval <...code>',\n\t\t\townerOnly: true\n\t\t});\n\t}\n\n\t@using(Middleware.localize)\n\tpublic async action(message: Message, [res]: [ResourceProxy]): Promise<any>\n\t{\n\t\t// @ts-ignore - Exposed for eval command invocations\n\t\tconst client: Client = this.client;\n\t\tconst [, , prefix, name] = await Util.wasCommandCalled(message);\n\t\tconst call: RegExp = new RegExp(`^${Util.escape(prefix)} *${name}`);\n\t\tconst code: string = message.content.replace(call, '').trim();\n\n\t\tif (!code) return this.respond(message, res.CMD_EVAL_ERR_NOCODE());\n\n\t\tlet evaled!: string | object;\n\t\tlet error!: string;\n\n\t\ttry { evaled = await eval(code); }\n\t\tcatch (err) { error = err; }\n\n\t\tif (error) return this.respond(message, res.CMD_EVAL_ERROR({ code, error: this._clean(error) }));\n\t\tif (typeof evaled !== 'string') evaled = inspect(evaled, { depth: 0 });\n\n\t\treturn this.respond(message, res.CMD_EVAL_RESULT({ code, result: this._clean(evaled) }));\n\t}\n\n\tprivate _clean(text: string): string\n\t{\n\t\treturn typeof text === 'string' ? text\n\t\t\t.replace(/`/g, `\\`${String.fromCharCode(8203)}`)\n\t\t\t.replace(/@/g, `@${String.fromCharCode(8203)}`)\n\t\t\t.replace(/[\\w\\d]{24}\\.[\\w\\d]{6}\\.[\\w\\d-_]{27}/g, '[REDACTED]')\n\t\t\t.replace(/email: '[^']+'/g, `email: '[REDACTED]'`)\n\t\t\t: text;\n\t}\n}\n"],"sourceRoot":"../../../src"}